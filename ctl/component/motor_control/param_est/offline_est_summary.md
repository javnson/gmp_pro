# 永磁同步电机（PMSM）参数自整定方案汇总

## 1. 概述

对永磁同步电机（PMSM）进行精确的参数辨识，是实现高性能矢量控制（FOC）的前提。控制器中的电流环、速度环以及弱磁控制、最大转矩电流比（MTPA）等高级算法，都高度依赖于准确的电机模型参数。本方案旨在为离线、可空载、无初始位置信息的PMSM提供一套完整、鲁棒的自动化参数辨识流程。

**辨识顺序**：我们将遵循“由静到动，由简入繁”的原则，依次辨识以下参数：

1. **定子电阻 (**Rs**)**
2. **交直轴电感 (**Ld,Lq**)** 及 **转子初始位置**
3. **永磁体磁链 (**ψf**)**
4. **转动惯量 (**J**)**

## 2. 定子电阻 (Rs) 辨识

定子电阻是电气模型的基础，其值的准确性直接影响电感和磁链的计算精度。

### 方法一：直流电压注入法（基础方法）

- **基本原理**：当向电机施加直流电压，待电流稳定后，电机绕组呈现为纯电阻特性。根据欧姆定律 R=V/I 计算电阻。
- **实施方法**：
  1. **施加电压**：在$\alpha\beta坐标系的\alpha轴方向施加一个恒定的直流电压U_\alpha$（例如，产生额定电流20%~50%的电压）。
  2. **测量电流**：等待$\alpha轴电流I_\alpha$完全稳定。
  3. **计算电阻**：Rs=Uα/Iα。
- **优点**：简单、直接、易于实现。
- **缺点**：单次测量可能存在误差；未利用三相信息。
- **鲁棒性增强**：可施加正反两个方向的电压进行两次测量后取平均值，以消除传感器零点漂移的影响。

### 方法二：六步换相定位法（推荐，若有编码器）

此方法将电阻辨识、编码器零点校准、极对数验证三项任务合一，效率极高。

- **基本原理**：通过给特定的两相绕组通以直流电，产生一个方向确定的定子磁场，转子会自动对齐到该磁场方向。依次切换通电相，让磁场旋转一个完整的电周期。
- **实施方法**：
  1. **六步励磁**：依次执行六步换相（如 A+B-, A+C-, B+C-, ...），每一步都代表一个60°电角度的步进。
  2. **数据采集**：在每一步转子稳定后，记录：
     - 两通电相之间的电压 Vphase−phase 和电流 Idc。
     - 编码器读数 θmech。
  3. **计算与分析**：
     - **电阻**Rs：每一步计算 Rs,i=Vphase−phase/(2⋅Idc)，最后取6次结果的平均值。
     - **编码器零点**：将第一步（如A+B-）的位置定义为0°电角度，记录此时的编码器读数作为零点偏移量。
     - **极对数**p**验证**：计算每一步之间编码器读数的变化量，理论上应相等。用60∘除以平均机械步进角，即可验证极对数。
- **优点**：一石多鸟，效率高；多次测量取平均，结果鲁棒；能完成系统健康自检。
- **缺点**：必须有编码器；对于IPM电机，磁阻转矩可能导致定位有微小偏差。

## 3. 电感 (Ld,Lq) 及转子位置辨识

电感辨识是FOC性能优化的关键，特别是对于内置式电机（IPMSM）。

### 方法一：高频旋转矢量注入法（无编码器首选）

- **基本原理**：利用PMSM的凸极效应，即d轴和q轴方向上的高频阻抗不同（通常Zd<Zq）。通过注入旋转的高频信号，寻找阻抗的极大和极小值方向，从而确定d,q轴位置及对应的电感。
- **实施方法**：
  1. **注入信号**：在$\alpha\beta坐标系下，注入一个高频正弦电压矢量，并让该矢量的方向\theta$从0到360°缓慢旋转。
  2. **测量响应**：测量对应的高频电流响应幅值Ihfi(θ)。
  3. **寻找极值**：
     - 电流幅值**最大**处，对应阻抗最小，即**d轴**方向。
     - 电流幅值**最小**处，对应阻抗最大，即**q轴**方向。
  4. **计算电感**：确定了d,q轴方向后，分别在这两个轴上单独注入高频信号，根据电压和电流响应计算Ld和Lq。
- **优点**：无需编码器或初始位置信息；测量的是非饱和状态下的电感，结果准确。
- **缺点**：算法实现相对复杂，需要进行信号处理和寻峰。

### 方法二：直流偏置HFI法

- **基本原理**：先用直流将转子“吸”到已知方向，再在该方向上叠加高频信号进行测量。
- **实施方法**：
  1. **对齐d轴**：在$\alpha轴施加直流电流I_\alpha$，将转子d轴对齐到控制器的$\alpha$轴。
  2. **测量**Ld：保持直流偏置，在$\alpha轴上叠加高频信号，测量响应并计算L_d$。
  3. **测量**Lq：保持直流偏置，在$\beta轴上叠加高频信号，测量响应并计算L_q$。
- **优点**：概念直观，实现相对简单，无需寻峰。
- **缺点**：**受直流偏置电流的磁饱和效应影响**，测得的电感值可能偏离电机正常工作点的值。

### 方法三：两阶段动态辨识法（鲁棒性策略）

这是一个组合策略，旨在提高自动化辨识的成功率。

- **阶段一：暂态法粗估平均电感**Lavg![img]()
  - **原理**：在辨识Rs时，利用施加直流电压阶跃后，电流从0上升过程中的暂态响应（一阶R-L电路特性）来估算。
  - **方法**：分析电流上升曲线的时间常数 τ=L/Rs。
  - **作用**：获得一个虽不精确但可靠的平均电感值Lavg，用于**设定一组稳定、安全的初始电流环PI参数**。
- **阶段二：动态法精辨**Ld,Lq,ψf![img]()
  - **原理**：利用已初步稳定的电流环，驱动电机在I-F（电流-频率）开环模式下以不同转速$\omega_e$运行。
  - **方法**：在每个稳定转速下，测量稳态的Ud,Uq,Id,Iq,ωe，联立多个转速下的电压方程组，一次性求解出Ld,Lq,ψf。此过程中需要HFI等方法实时观测真实的转子位置。
- **优点**：**鲁棒性极高**。通过“粗估->稳定控制器->精辨”的流程，解决了“先有鸡还是先有蛋”的问题。
- **缺点**：流程最复杂，但自动化程度和可靠性最高。

## 4. 永磁体磁链 (ψf) 辨识

磁链决定了电机的转矩和反电动势能力，其值受温度影响较大。

### 方法一：恒速反电动势法（标准方法）

- **基本原理**：电机空载匀速旋转时，其反电动势（Back-EMF）的幅值与磁链和转速成正比。在Id=0,Iq=0的理想空载条件下，q轴电压方程简化为 Uq=ωeψf。
- **实施方法**：
  1. **驱动电机**：使用FOC，在Id=0的模式下，将电机驱动到某个稳定转速$\omega_e$。
  2. **测量数据**：记录此时的q轴电压Uq和电角速度$\omega_e$。
  3. **计算磁链**：ψf=Uq/ωe。
- **校验与增强**：在多个不同转速下进行测量，绘制Uq−ωe关系图。这些点应能拟合成一条过原点的直线，**直线的斜率即为$\psi_f$**。这能极好地验证辨识的准确性。
- **优点**：原理简单，结果可靠，是离线标定的“黄金标准”。
- **缺点**：只能离线，无法反映运行中的温度变化。

### 方法二：其他离线/在线策略

| 方法名称           | 基本原理                                                     | 优点                    | 缺点                   | 主要应用场景               |
| ------------------ | ------------------------------------------------------------ | ----------------------- | ---------------------- | -------------------------- |
| **减速停车法**     | 对比有无电磁制动时的自由减速曲线，分离出摩擦力影响。         | 动态辨识，可交叉验证J。 | 实现稍复杂。           | 实验室精确建模，交叉验证。 |
| **静态转矩测量法** | 用转矩传感器直接测量已知Iq下的输出转矩。                     | **最直接的物理验证**。  | **需外部转矩传感器**。 | 设计验证，精确标定。       |
| **MRAS在线观测**   | 模型参考自适应。用真实电流与模型估算电流的误差来修正磁链估算值。 | 可在线跟踪温漂。        | 算法复杂，需调试。     | 高性能伺服，补偿温度影响。 |
| **EKF在线观测**    | 扩展卡尔曼滤波。将磁链作为状态变量之一进行最优估计。         | 精度和鲁棒性高。        | **计算量巨大**。       | 要求极高的驱动系统。       |

## 5. 转动惯量 (J) 辨识

转动惯量是机械系统参数，对速度环的动态响应至关重要。

- **基本原理**：基于牛顿第二定律的旋转形式 Te−TL=J⋅dωm/dt。在空载且忽略摩擦力的情况下，施加一个阶跃转矩，惯量等于该转矩除以产生的角加速度。
- **实施方法**：
  1. **施加转矩阶跃**：电机静止或低速运行时，突然施加一个恒定的q轴电流Iq,step（Id=0），产生阶跃转矩 Te=23pψfIq,step。
  2. **测量加速度**：测量电机角加速度$\alpha_m = d\omega_m/dt$。
  3. **计算惯量**：J=Te/αm。
- **优点**：原理清晰。
- **缺点**：对加速度的计算（速度微分）对噪声敏感；忽略了摩擦力，可能导致结果偏小。